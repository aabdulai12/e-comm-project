<h1>Customer Orders Dashboard</h1>

<table class="table table-bordered table-striped">
  <thead>
    <tr>
      <th>Customer Name</th>
      <th>Email</th>
      <th>Orders</th>
    </tr>
  </thead>
  <tbody>
    <% @customers.each do |customer| %>
      <tr>
        <td><%= "#{customer.first_name} #{customer.last_name}" %></td>
        <td><%= customer.email %></td>
        <td>
          <table class="table table-sm">
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Products</th>
                <th>Subtotal</th>
                <th>GST</th>
                <th>PST</th>
                <th>HST</th>
                <th>Grand Total</th>
              </tr>
            </thead>
            <tbody>
              <% customer.orders.each do |order| %>
                <tr>
                  <td><%= order.id %></td>
                  <td>
                    <% order.order_items.each do |item| %>
                      <p><%= "#{item.quantity}x #{item.product.name} (#{number_to_currency(item.price)})" %></p>
                    <% end %>
                  </td>
                  <td><%= number_to_currency(order.subtotal) %></td>
                  <td><%= number_to_currency(order.gst) %></td>
                  <td><%= number_to_currency(order.pst) %></td>
                  <td><%= number_to_currency(order.hst) %></td>
                  <td><%= number_to_currency(order.total) %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
